class ModernHowItWorks{constructor(){(this.currentStep=0),(this.totalSteps=4),(this.isAnimating=!1),(this.cardPositions=[]),(this.intersectionObserver=null),(this.particleSystem=null),(this.textAnimationQueue=[]),this.init()}
init(){this.setupElements(),this.setupIntersectionObserver(),this.setupEventListeners(),this.initializeParticleSystem(),this.startTextRevealAnimations(),this.setupMagneticEffects(),this.initializeCarousel()}
setupElements(){(this.container=document.querySelector(".how-it-works")),(this.stepsWrapper=document.querySelector(".how-it-works-steps-wrapper")),(this.stepCards=document.querySelectorAll(".how-it-works-step-card")),(this.sectionHeader=document.querySelector(".how-it-works-section-header")),(this.floatingElements=document.querySelectorAll(".how-it-works-float-element")),(this.titleLines=document.querySelectorAll(".how-it-works-title-line")),(this.navigationDots=document.querySelectorAll(".dot")),this.prevArrow=document.querySelector(".prev-arrow");this.nextArrow=document.querySelector(".next-arrow");(this.cardPositions=Array.from({length:this.totalSteps},(t,e)=>e))}
initializeCarousel(){this.updateCardPositions(),this.stepCards.forEach((t,e)=>{t.classList.remove("active","prev","next","far-left","far-right"),0===e&&t.classList.add("active")}),this.updateNavigationDots()}
setupIntersectionObserver(){(this.intersectionObserver=new IntersectionObserver((t)=>{t.forEach((t)=>{t.isIntersecting&&this.animateSection()})},{root:null,rootMargin:"0px",threshold:0.3})),this.intersectionObserver.observe(this.container)}
setupEventListeners(){this.stepCards.forEach((t,e)=>{t.addEventListener("click",()=>this.goToStep(e)),t.addEventListener("mouseenter",()=>this.handleCardHover(e)),t.addEventListener("mouseleave",()=>this.handleCardLeave(e))}),this.navigationDots.forEach((t,e)=>{t.addEventListener("click",()=>this.goToStep(e))}),document.addEventListener("keydown",(t)=>{this.isInViewport()&&("ArrowLeft"===t.key&&this.previousStep(),"ArrowRight"===t.key&&this.nextStep())});if(this.prevArrow&&this.nextArrow){this.prevArrow.addEventListener("click",()=>this.previousStep());this.nextArrow.addEventListener("click",()=>this.nextStep())}}
goToStep(t){if(this.isAnimating||t===this.currentStep)return;this.isAnimating=!0;this.currentStep;const e=t>this.currentStep?1:-1,s=Math.abs(t-this.currentStep);this.animateCarousel(e,s,t),(this.currentStep=t),setTimeout(()=>{this.particleSystem.burst(this.stepCards[this.findCardAtPosition("center")])},400),this.updateNavigationDots(),setTimeout(()=>{this.isAnimating=!1},800)}
animateCarousel(t,e,s){for(let s=0;s<e;s++)
if(1===t){const t=this.cardPositions.shift();this.cardPositions.push(t)}else{const t=this.cardPositions.pop();this.cardPositions.unshift(t)}
this.updateCardPositions(),setTimeout(()=>{this.updateCardStates()},400)}
updateCardPositions(){this.stepCards.forEach((t,e)=>{const s=this.cardPositions.indexOf(e);this.applyCardPosition(t,s)})}
applyCardPosition(t,e){t.classList.remove("active","prev","next","far-left","far-right");let s="",i=0.6,n=0.75,r=1;switch(e){case 0:(s="translateX(0) scale(1)"),(i=1),(n=1),(r=10),t.classList.add("active");break;case 1:(s="translateX(320px) scale(0.75)"),(i=0.6),(r=5),t.classList.add("next");break;case 2:(s="translateX(580px) scale(0.75)"),(i=0.4),(r=2),t.classList.add("far-right");break;case 3:(s="translateX(-320px) scale(0.75)"),(i=0.6),(r=5),t.classList.add("prev")}(t.style.transform=s),(t.style.opacity=i),(t.style.zIndex=r),(t.style.transition="all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94)")}
updateCardStates(){this.stepCards.forEach((t,e)=>{const s=0===this.cardPositions.indexOf(e);this.animateCardContent(t,s)})}
animateCardContent(t,e){const s=t.querySelector(".how-it-works-step-number"),i=t.querySelector(".how-it-works-step-title"),n=t.querySelector(".how-it-works-step-description"),r=t.querySelector(".how-it-works-step-image img");e?(setTimeout(()=>{(s.style.transform="scale(1.2) rotateY(360deg)"),(s.style.filter="drop-shadow(0 0 20px rgba(168, 85, 247, 0.6))")},200),setTimeout(()=>{(i.style.transform="translateX(0)"),(i.style.opacity="1"),(i.style.filter="drop-shadow(0 0 10px rgba(168, 85, 247, 0.3))")},400),setTimeout(()=>{(n.style.transform="translateY(0)"),(n.style.opacity="1")},600),(r.style.transform="scale(1.05)"),(r.style.filter="brightness(1.1) saturate(1.2)")):((s.style.transform="scale(1) rotateY(0deg)"),(s.style.filter="none"),(i.style.transform="translateX(-20px)"),(i.style.opacity="0.7"),(i.style.filter="none"),(n.style.transform="translateY(10px)"),(n.style.opacity="0.6"),(r.style.transform="scale(1)"),(r.style.filter="brightness(0.8) saturate(0.8)"))}
findCardAtPosition(t){const e={center:0,right:1,"far-right":2,left:3}[t];return this.cardPositions[e]}
nextStep(){const t=(this.currentStep+1)%this.totalSteps;this.goToStep(t)}
previousStep(){const t=(this.currentStep-1+this.totalSteps)%this.totalSteps;this.goToStep(t)}
updateNavigationDots(){this.navigationDots.forEach((t,e)=>{t.classList.toggle("active",e===this.currentStep)})}
handleCardHover(t){if(this.isAnimating)return;const e=this.stepCards[t],s=e.querySelector(".how-it-works-card-glow");s&&((s.style.opacity="0.7"),(s.style.transform="scale(1.05)")),(e.style.transform=e.style.transform.replace("scale(0.75)","scale(0.8)").replace("scale(1)","scale(1.02)"))}
handleCardLeave(t){if(this.isAnimating)return;const e=this.stepCards[t],s=e.querySelector(".how-it-works-card-glow"),i=this.cardPositions.indexOf(t);s&&0!==i&&((s.style.opacity="0"),(s.style.transform="scale(1)"));const n=0===i?"scale(1)":"scale(0.75)";e.style.transform=e.style.transform.replace(/scale\([^)]*\)/,n)}
initializeParticleSystem(){this.particleSystem=new ParticleSystem(this.container)}
startTextRevealAnimations(){this.animateText(".how-it-works-how-subtitle","slideInUp",0.5),this.titleLines.forEach((t,e)=>{this.animateText(t,"slideInUp",0.7+0.2*e)}),this.stepCards.forEach((t,e)=>{const s=t.querySelector(".how-it-works-step-title"),i=t.querySelector(".how-it-works-step-description");this.animateText(s,"fadeInUp",1.2+0.1*e),this.animateText(i,"fadeInUp",1.4+0.1*e)})}
animateText(t,e,s){"string"==typeof t&&(t=document.querySelector(t)),t&&((t.style.opacity="0"),(t.style.transform="translateY(50px)"),setTimeout(()=>{(t.style.transition="all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94)"),(t.style.opacity="1"),(t.style.transform="translateY(0)"),t.classList.contains("how-it-works-gradient-text")&&(t.style.animation="gradientShift 3s ease-in-out infinite")},1e3*s))}
animateSection(){this.sectionHeader.classList.add("animate"),this.floatingElements.forEach((t,e)=>{setTimeout(()=>{(t.style.opacity="1"),(t.style.transform="scale(1)")},200*e)}),this.initializeCarousel()}
setupMagneticEffects(){this.stepCards.forEach((t,e)=>{t.addEventListener("mousemove",(s)=>{if(this.isAnimating)return;const i=t.getBoundingClientRect(),n=0.02*(s.clientX-i.left-i.width/2),r=(s.clientY,i.top,i.height,this.cardPositions.indexOf(e)),a=t.style.transform;t.style.transform=a.replace(/translateX\([^)]*\)/,`translateX(${this.getBaseTranslateX(r) + n}px)`)}),t.addEventListener("mouseleave",()=>{if(this.isAnimating)return;const s=this.cardPositions.indexOf(e);this.applyCardPosition(t,s)})})}
getBaseTranslateX(t){return{0:0,1:320,2:580,3:-320}[t]||0}}
class ParticleSystem{constructor(t){(this.container=t),(this.particles=[])}
burst(t){const e=t.getBoundingClientRect(),s=e.left+e.width/2,i=e.top+e.height/2;for(let t=0;t<12;t++)this.createParticle(s,i);}
createParticle(t,e){const s=document.createElement("div");s.className="particle";const i=2*Math.PI*Math.random(),n=50+50*Math.random(),r=2+2*Math.random();(s.style.left=t+"px"),(s.style.top=e+"px"),s.style.setProperty("--vx",Math.cos(i)*n+"px"),s.style.setProperty("--vy",Math.sin(i)*n+"px"),s.style.setProperty("--life",r+"s"),document.body.appendChild(s);const a=[{transform:"translate(0, 0) scale(1) rotate(0deg)",opacity:1,filter:"brightness(1) blur(0px)",},{transform:`translate(${Math.cos(i) * n}px, ${
          Math.sin(i) * n
        }px) scale(0.5) rotate(360deg)`,opacity:0,filter:"brightness(2) blur(2px)",},];s.animate(a,{duration:1e3*r,easing:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fill:"forwards",}).onfinish=()=>s.remove()}}
function addDynamicStyles(){const t=document.createElement("style");(t.textContent="\n        .how-it-works-steps-wrapper {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            position: relative;\n            width: 100%;\n            height: 600px;\n            overflow: visible;\n        }\n        \n        .how-it-works-step-card {\n            position: absolute;\n            width: 400px;\n            height: 550px;\n            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n            cursor: pointer;\n        }\n        \n        .how-it-works-step-card.active {\n            z-index: 10;\n        }\n        \n        .how-it-works-step-card:hover {\n            transform: translateY(-5px);\n        }\n        \n        .how-it-works-step-number {\n            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        }\n        \n        .how-it-works-step-title {\n            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        }\n        \n        .how-it-works-step-description {\n            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        }\n        \n        .how-it-works-step-image img {\n            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        }\n        \n        .how-it-works-card-glow {\n            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n        }\n        \n        @keyframes textGlow {\n            0%, 100% { text-shadow: 0 0 5px rgba(168, 85, 247, 0.3); }\n            50% { text-shadow: 0 0 20px rgba(168, 85, 247, 0.6), 0 0 30px rgba(59, 130, 246, 0.4); }\n        }\n        \n        .how-it-works-step-card.active .how-it-works-step-title {\n            animation: textGlow 2s ease-in-out infinite;\n        }\n        \n        @keyframes pulseGlow {\n            0%, 100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.3); }\n            50% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.6), 0 0 60px rgba(59, 130, 246, 0.4); }\n        }\n        \n        .how-it-works-step-card.active {\n            animation: pulseGlow 3s ease-in-out infinite;\n        }\n        \n        .particle {\n            filter: drop-shadow(0 0 6px rgba(168, 85, 247, 0.8));\n        }\n    "),document.head.appendChild(t)}
export function initHowItWorksSection(){new ModernHowItWorks(),new ParticleSystem(),new addDynamicStyles()}